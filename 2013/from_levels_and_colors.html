<!DOCTYPE html>
<html class=" js inlinesvg">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <title>Drawing a pseudo-colour blockplot (pcolormesh) in matplotlib with levels and specific colours by Phil Elson - Software | Science | Python</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width">

  <!-- Styles -->
  <link rel="stylesheet" href="../theme/css/styles-bluegreen.css" id="theme-styles">

  <!-- Bootstrap styles -->
  <link rel="stylesheet" href="../theme/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="../theme/bootstrap/css/bootstrap-theme.min.css">

  <!-- Font-Awesome -->
  <link rel="stylesheet" href="../theme/font-awesome/css/font-awesome.min.css">

  <!-- Google Webfonts -->
  <link href="../theme/webfonts.css" rel="stylesheet" type="text/css">



  <!--[if lt IE 9]>
  <script src="theme/js/html5-3.6-respond-1.1.0.min.js"></script>
  <![endif]-->

  <script src="../theme/jquery.min.js"></script>

  <link href="../" type="application/atom+xml" rel="alternate" title="Phil Elson - Software | Science | Python ATOM Feed" /> <script type="text/javascript">
  var switchTo5x = true;
</script>

<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">
  stLight.options({
    publisher: "6668e56b-d9f6-4324-8c39-1543fefa1fdf",
    doNotHash: false,
    doNotCopy: false,
    hashAddressBar: false
  });
</script>
<style type="text/css">
    stButton_gradient {height: 100%;}
  </style>

</head>

<body>


  <header>
    <div class="widewrapper masthead">
      <div class="container">
        <a href="../index.html" id="logo" class="h1">
        Phil Elson
      </a>
        <!--
        <div id="mobile-nav-toggle" class="pull-right">
          <a href="#" data-toggle="collapse" data-target=".pelson-nav .navbar-collapse">
            <i class="fa fa-bars"></i>
          </a>
        </div>

      <nav class="pull-right pelson-nav">
        <div class="collapse navbar-collapse">

          <ul class="nav nav-pills navbar-nav">

            <li class="dropdown active">
              <a class="dropdown-toggle" data-toggle="dropdown" href="index.html#">
                Blog
                <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li class="active"><a href="../category/python.html">Python</a></li>
                <li><a href="theme/pelson - Blog.html">Blog</a></li>
                <li><a href="blog-detail.html">Blog Detail</a></li>
              </ul>
            </li>

            <li>
              <a href="about.html">About</a>
            </li>
            <li>
              <a href="credits.html">Credits</a>
            </li>
          </ul>

        </div>
      </nav>
    -->
      </div>
    </div>


    <!--
  <div class="widewrapper subheader">
    <div class="container">
      <div class="pelson-breadcrumb">
        <a href="index.html#">Blog</a>
      </div>

      <div class="pelson-searchbox">
      <form action="#" method="get" accept-charset="utf-8">
      <button class="searchbutton" type="submit">
      <i class="fa fa-search"></i>
    </button>
    <input class="searchfield" id="searchbox" type="text" placeholder="Search">
  </form>
</div>

</div>
-->
    </div>
  </header>

  <div class="widewrapper main">

    <div class="container">
      <div class="row">
        <div class="col-md-8 blog-main">
  <h2 id="single">Drawing a pseudo-colour blockplot (pcolormesh) in matplotlib with levels and specific colours</h2>
  <img class="article-image" src="../images/from_levels_and_colors/thumb.png" />   <div class="date entry-info">
    <p>Fri 03 May 2013</p>
  </div>

  <div class="entry">
    <p>I recently added a new function to matplotlib to make it easier to draw pseudo-colour
plots given specific levels and colours, in exactly the same way as you can with contour
and contourf.</p>


<p>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[2]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">from_levels_and_colors</span>

<span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">from_levels_and_colors</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="s">&#39;green&#39;</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="../images/from_levels_and_colors/using_output_0_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It&#39;s also possible to easily add &quot;extend&quot; like capabilities, similar to that of contourf</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[3]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">from_levels_and_colors</span>

<span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">from_levels_and_colors</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="s">&#39;green&#39;</span><span class="p">],</span> <span class="n">extend</span><span class="o">=</span><span class="s">&#39;max&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="../images/from_levels_and_colors/using_output_2_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you already have a colormap that you want to use as the source of your colours it is possible to call the colormap with the index of the colour.</p>
<p>I&#39;m going to be using Iris&#39; nice descrete Brewer colour palettes</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[4]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">import</span> <span class="nn">iris.palette</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">NoNorm</span>

<span class="n">nice_cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&#39;brewer_RdYlBu_11&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;The &quot;brewer_RdYlBu_11&quot; cmap&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nice_cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="n">NoNorm</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">nice_cmap</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">(</span><span class="n">tight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="../images/from_levels_and_colors/using_output_4_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lets go ahead and start using the new from_levels_and_colors function.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[5]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">import</span> <span class="nn">iris</span>
<span class="kn">import</span> <span class="nn">iris.palette</span>
<span class="kn">import</span> <span class="nn">iris.quickplot</span> <span class="kn">as</span> <span class="nn">qplt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">from_levels_and_colors</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">fname</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">sample_data_path</span><span class="p">(</span><span class="s">&#39;air_temp.pp&#39;</span><span class="p">)</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">load_cube</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

<span class="n">nice_cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&#39;brewer_RdYlBu_11&#39;</span><span class="p">)</span>
<span class="c"># Pick some of the nicer colors from the palette...</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">nice_cmap</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">265</span><span class="p">,</span> <span class="mi">275</span><span class="p">,</span> <span class="mi">285</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>

<span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">from_levels_and_colors</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s">&#39;both&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">qplt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="../images/from_levels_and_colors/using_output_6_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the record, the PR also adds a new method on a colormap instance to quickly see what it looks like (EDIT: Sadly, this was removed from the pull request):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
In&nbsp;[6]:
</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">nice_cmap</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="../images/from_levels_and_colors/using_output_8_0.png"
>
</div>

</div>

</div>
</div>

</div></p>
  </div>

  <hr />

  <div id="share_buttons">
    <span class="st_googleplus_hcount" displayText="Google +"></span>
    <span class="st_facebook_hcount" displayText="Facebook"></span>
    <span class="st_twitter_hcount" displayText="Tweet"></span>
    <span class="st_pinterest_hcount" displayText="Pinterest"></span>
    <span class="st_email_hcount" displayText="Email"></span>
    <span class="st_sharethis_hcount" displayText="ShareThis"></span>
    <span class="st_fblike_hcount" displayText="Facebook Like"></span>
  </div>
  <br /> 
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = "pelson";

    (function() {
      var dsq = document.createElement("script");
      dsq.type = "text/javascript";
      dsq.async = true;
      dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
      (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
        <aside class="col-md-4 blog-aside">

          <div class="aside-widget">
            <header>
              <h3>Most recent articles</h3>
            </header>
            <div class="body">
              <ul class="pelson-list">
                 <li><a href="../2014/nbagg_backend.html">Interactive matplotlib figures in the IPython notebook - they've landed!</a></li>
                <li><a href="../2013/massive_virtual_arrays_with_biggus.html">Dealing with arrays which are bigger than memory - an intoduction to biggus</a></li>
                <li><a href="../2013/working_with_colors_in_matplotlib.html">Working with colours in matplotlib</a></li>
                <li><a href="../2013/from_levels_and_colors.html">Drawing a pseudo-colour blockplot (pcolormesh) in matplotlib with levels and specific colours</a></li>
               </ul>
            </div>
          </div>

 
          <div class="aside-widget">
            <header>
              <h3>Tags</h3>
            </header>
            <div class="body">
              <ul class="tags">

                <li >
                  <a href="../tag/biggus.html">biggus</a>
                </li>
                <li class="active" >
                  <a href="../tag/matplotlib.html">matplotlib</a>
                </li>
                <li >
                  <a href="../tag/medium-data.html">medium data</a>
                </li>
                <li class="active" >
                  <a href="../tag/python.html">Python</a>
                </li>
              </ul>
            </div>
          </div>
  
        </aside>
      </div>
    </div>
  </div>

  <footer>
    <div class="widewrapper footer">
      <div class="container">
        <div class="row">
          <div class="col-xs-6 footer-widget">
            <h3> <i class="fa fa-envelope"></i>Contact</h3>
            <ul class="unstyled">
              <li>
                <a href="http://github.com/pelson">
                  <i class="fa fa-github fa-3x"></i> @pelson on Github
                </a>
              </li>

              <li>
                <a href="https://twitter.com/pypelson">
                  <i class="fa fa-twitter fa-3x"></i> @pypelson
                </a>
              </li>

              <li>
                <a href="http://stackoverflow.com/users/741316/pelson">
                  <i class="fa fa-stack-overflow fa-3x"></i> @pelson on stackoverflow
                </a>
              </li>

              <li>
                <a href="http://uk.linkedin.com/in/philipelson/">
                  <i class="fa fa-linkedin-square fa-3x"></i> LinkedIn
                </a>
              </li>

              <li>
                <a href="https://bitbucket.org/pelson">
                  <i class="fa fa-bitbucket fa-3x"></i> Bitbucket
                </a>
              </li>

              <li>
                <a href="https://plus.google.com/u/1/103760955300350111400">
                  <i class="fa fa-google-plus-square fa-3x"></i> Google+
                </a>
              </li>

              <li>
                <a href="">
                  <i class="fa fa-envelope fa-3x"></i>
                  <span style="unicode-bidi:bidi-override; direction:rtl;">moc.liamg
                    <span style="display: none;">_ignore_</span>@golb+bup.noslep</span>
                </a>
              </li>
            </ul>

          </div>

          <div class="col-xs-6 footer-widget">
            <h3> <i class="fa fa-info-circle"></i>About</h3>
            <span>
              This site is generated using a combination of Pelican and IPython notebook, the source can be found at
              <a href="https://github.com/pelson/pelson.github.com">https://github.com/pelson/pelson.github.com</a>.
            </span>
          </div>
        </div>
      </div>
    </div>
    <div class="widewrapper copyright">
      <div class="container">
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
          <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" />
        </a>
        <a href="https://pelson.github.io">
          <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">pelson.github.io</span>
        </a> is licensed under a
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
      </div>
    </div>
  </footer>

  <script src="../theme/bootstrap/js/bootstrap.min.js"></script>
  <script src="../theme/modernizr.js"></script>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-29774503-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
 <a href="http://github.com/pelson/pelson.github.io">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
</body>

</html>